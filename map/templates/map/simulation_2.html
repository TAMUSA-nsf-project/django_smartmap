{% extends "main/base.html" %}
{% load static %}

{% block extend_head %}

    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>

    <script>
      $(function() {
        $('#toggle-event').change(function() {
            var toggle_tf = $(this).prop('checked')
          $('#console-event').html('Toggle: ' + $(this).prop('checked'))
            var myInterval;
            if (toggle_tf) {
                const timenow = Date.now().toString()

                const fruits = ["Banana", "Orange", "Apple"]

                const data_out = {'file_name': timenow, 'pos_data': fruits}

                jQuery.ajax({
                    url: "{% url 'map:simulation-ajax' %}",
                    //data: {'file_name': timenow, 'pos_data': JSON.stringify(fruits)},
                    data: {'data': JSON.stringify(data_out) },
                    type: "GET",
                    //dataType: 'json', // dataType specifies the type of data expected back from the server,
                    dataType: 'html',  // in this example HTML data is sent back via HttpResponse in views.py
                    success: callbackFunc,
                });

                function callbackFunc(data) {
                    if (data) {
                        console.log("SUCCESS!");
                    } else {
                        console.log("FAILURE!");
                    }
                }

                } else {
                    clearInterval(myInterval);
                }

        })
      })
    </script>

{% endblock %}


{% block content %}
    <div class="container mt-5">
        <input id="toggle-event" type="checkbox" data-toggle="toggle" data-on="Recording" data-off="">
        <div id="console-event"></div>
    </div>


{% endblock %}
